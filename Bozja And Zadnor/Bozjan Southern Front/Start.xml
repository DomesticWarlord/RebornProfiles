<?xml version="1.0" encoding="utf-8"?>
<!--
  Profile: Bozjan Southern Front
  Authors: DomesticWarlord86
-->
<Profile>
  <Name>Bozjan Southern Front</Name>
  <BehaviorDirectory></BehaviorDirectory>
  <Order>
  
	<RunCode name="Disable_Flight"/>
  
	<If Condition="not IsQuestCompleted(69477)">  
		<LLoadProfile Path="Quests/Resistance Relics Unlock.xml"/>
	</If>  

	<If Condition="not IsOnMap(920)">  
		<If Condition="not IsOnMap(915)">	
			<While Condition="not IsOnMap(759)">
				<TeleportTo AetheryteId="127"/> <!-- The Doman Enclave -->
			</While>				
			<GetTo ZoneId="759" XYZ="126.2195, -4.178713, 97.66013"/>
			<UseTransport NpcId="1032884" InteractDistance="3.0" XYZ="127.2754, -4.178713, 98.68005"/>
		</If>
		<MoveTo ZoneId="915" XYZ="-27.72526, -0.5876654, -33.76041"/>
		<RunCode name="EnterBozjan"/>
	</If>
	
	<If Condition="IsOnMap(920)">  
		<LLoadProfile Path="Profiles/Bozjan Leveling.xml"/>
	</If>	
	
	
  
  </Order>
  <GrindAreas>
  </GrindAreas>
  <CodeChunks>
		<CodeChunk Name="Disable_Flight">
		<![CDATA[
			foreach (var plugin in PluginManager.Plugins.Where(p => p.Plugin.Name == "Enable Flight" || p.Plugin.Name == "启用飞行"))
			{
			try
			{
				if (!plugin.Enabled)  {  break;  }  else  {  plugin.Enabled = false;  }
			}
			catch (Exception ex) {  }
			}
		]]>
		</CodeChunk>
<CodeChunk Name="EnterBozjan">
			<![CDATA[
				var npcId = GameObjectManager.GetObjectByNPCId(1032080);

					if (!npcId.IsWithinInteractRange)

						{
							var _target = npcId.Location;
							Navigator.PlayerMover.MoveTowards(_target);
							while (_target.Distance2D(Core.Me.Location) >= 4)
								{
									Navigator.PlayerMover.MoveTowards(_target);
									await Coroutine.Sleep(100);
								}
									Navigator.PlayerMover.MoveStop();
								}

					npcId.Interact();

					await Coroutine.Wait(10000, () => SelectString.IsOpen);
					await Buddy.Coroutines.Coroutine.Sleep(500);
					{
					if (ConditionParser.IsQuestCompleted(69620)||ConditionParser.GetQuestStep(69620) >= 1)
						{
							Logging.WriteDiagnostic("Selecting 'The Bozjan Southern Front'.");
							ff14bot.RemoteWindows.SelectString.ClickSlot(2);
							await Coroutine.Wait(10000, () => SelectString.IsOpen);
							await Buddy.Coroutines.Coroutine.Sleep(500);
							{
								Logging.WriteDiagnostic("Selecting 'Enter the Bozjan southern front'.");
								ff14bot.RemoteWindows.SelectString.ClickSlot(0);
							}							
						}					
						if (ConditionParser.IsQuestCompleted(69562)||ConditionParser.GetQuestStep(69562) >= 1)
						{
							Logging.WriteDiagnostic("Selecting 'The Bozjan Southern Front'.");
							ff14bot.RemoteWindows.SelectString.ClickSlot(1);
							await Coroutine.Wait(10000, () => SelectString.IsOpen);
							await Buddy.Coroutines.Coroutine.Sleep(500);
							{
								Logging.WriteDiagnostic("Selecting 'Enter the Bozjan southern front'.");
								ff14bot.RemoteWindows.SelectString.ClickSlot(0);
							}							
						}
						else if (!ConditionParser.IsQuestCompleted(69562))
						{
							Logging.WriteDiagnostic("Selecting 'Enter the Bozjan southern front'.");
							ff14bot.RemoteWindows.SelectString.ClickSlot(0);
							await Coroutine.Wait(10000, () => SelectString.IsOpen);
							await Buddy.Coroutines.Coroutine.Sleep(500);
							{
								Logging.WriteDiagnostic("Selecting 'Enter the Bozjan southern front'.");
								ff14bot.RemoteWindows.SelectString.ClickSlot(0);
							}								
						}						
					}										

					await Coroutine.Wait(5000, () => ContentsFinderConfirm.IsOpen);
					await Buddy.Coroutines.Coroutine.Sleep(500);
				   
					if (ff14bot.RemoteWindows.ContentsFinderConfirm.IsOpen)						
						{
							Logging.WriteDiagnostic("Commencing Duty.");
							ff14bot.RemoteWindows.ContentsFinderConfirm.Commence();
							await Coroutine.Wait(10000, () => CommonBehaviors.IsLoading);
							   if (CommonBehaviors.IsLoading)
							   {
								   await Coroutine.Wait(-1, () => !CommonBehaviors.IsLoading);
							   }									
						}			
			]]>			
		</CodeChunk>		
  </CodeChunks>
</Profile>  